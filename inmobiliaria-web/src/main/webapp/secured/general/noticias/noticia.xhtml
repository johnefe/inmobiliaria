<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<h:head>
		<title>#{msg['msg.tituloPrincipal']}</title>
	</h:head>
	<h:body>
		<ui:composition template="/layouts/default.xhtml">
			<ui:define name="content">
				<h:form id="form1" prependId="false">
					<h:panelGroup rendered="#{newsBean.actual eq null}">
						<div class="col-sm-12">
							<div class="box">
								<p:messages id="messages" showDetail="true" autoUpdate="false" closable="true" globalOnly="true" for="form1" />
								<div class="box-header with-border">
									<label class="title-head">Noticias</label>
								</div>
								<div class="box-body">
									<div class="col-sm-12 x_title panel-heading">
										<label class="subtitle-head">#{msg['lbl.listadoNoticias']}</label>
									</div>
									<div class="div-btn-header">
										<p:commandButton title="#{msg['lbl.nuevo']}" process="@this" action="#{newsBean.nuevo()}" rendered="#{newsBean.actual eq null}" update=":form1 :formRegisterNew" onstart="showSpinner();" onsuccess="hideSpinner();" styleClass="btn-ic" icon="ic-btn ic-btn-new" />
									</div>
									<div class="clearfix"></div>
									<div class="col-sm-12">
										<h:panelGroup id="tablaregistros">
											<div class="panel-body form-table">
												<p:dataTable id="tblNoticias" widgetVar="table1" var="noti" value="#{newsBean.newsList}" 
						 							paginatorAlwaysVisible="false" paginatorPosition="bottom" rows="5" paginator="true"
													paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
													emptyMessage="No se encontraron registros" rowsPerPageTemplate="5,10,15">
													<p:column style="width:180px;" headerText="Titulo" sortBy="#{noti.titulo}" priority="1"
														filterBy="#{noti.titulo}" filterMatchMode="contains"> 
														<h:outputText style="text-transform: capitalize" value="#{noti.titulo}" />
													</p:column>
													<p:column headerText="Descripción" priority="2">
														<div class="block-with-text">
														<h:outputText value="#{noti.descripcion}" escape="false" />
														</div>
													</p:column>
													<p:column style="width:200px;" headerText="Autor" priority="3" filterBy="#{noti.autor}" filterMatchMode="contains">
														<h:outputText value="#{noti.autor}" />
													</p:column>
													<p:column style="width:100px;" priority="4" headerText="Fecha de Registro">
														<h:outputText value="#{noti.registro}" >
															<f:convertDateTime pattern="dd-MM-yyyy" />
														</h:outputText>
													</p:column>
													<p:column width="60">
														<p:commandButton process="@this" action="#{newsBean.loadNews(noti.id)}" update=":form1 :formRegisterNew" title="#{msg['lbl.editar']}"
																		icon="ic-btn-little ic-btn-edit" styleClass="btn-ic-little" onstart="showSpinner();" onsuccess="hideSpinner();" />
													</p:column>
												</p:dataTable>
											</div>
										</h:panelGroup>
									</div>
								</div>
							</div>
						</div>
					</h:panelGroup>
				</h:form>
				<h:form prependId="false" id="formRegisterNew">
				<p:messages id="messages_formRe" showDetail="true" autoUpdate="false" closable="true" globalOnly="true" for="formRegisterNew" />
					<h:panelGroup rendered="#{newsBean.actual ne null}">
						<div class="col-sm-12">
							<div class="box">
								<div class="box-header with-border">
									<label class="title-head">Noticias</label>
								</div>
								<div class="box-body">
									<div class="col-sm-12 x_title panel-heading">
										<label class="subtitle-head">#{newsBean.actual.id eq null ? 'Registrar' : 'Editar'} Noticia</label>
										<div class="clearfix"></div>
									</div>
									<div class="form-group">
										<div class="form-group col-md-4 col-sm-4">
											<label for="titulo" class="col-sm-12 control-label required">Titulo</label> 
											<h:inputText type="text" class="form-control" id="titulo" 
												value="#{newsBean.actual.titulo}" required="true" requiredMessage="#{msg['obligatoryField']}" />
											<p:message for="titulo" display="text" />
										</div>
										<div class="form-group col-md-3 col-sm-3">
											<label for="autor" class="col-sm-12 control-label required">Autor</label> 
											<h:inputText type="text" class="form-control" id="autor" 
												value="#{newsBean.actual.autor}" required="true" requiredMessage="#{msg['obligatoryField']}" />
											<p:message for="autor" display="text" />
										</div>
										<div class="form-group col-md-5 col-sm-5">
											<label for="enlace" class="col-sm-12 control-label">Enlace</label> 
											<h:inputText type="text" class="form-control" id="enlace" 
												value="#{newsBean.actual.enlace}"  />
										</div>
									</div>
									<div class="clearfix"></div>
									<div class="form-group">
										<div class="col-md-12 col-sm-12" >
											<label for="descripcion" class="col-sm-12 control-label required">Descripción</label>
											<div class="clearfix"></div>
											<p:textEditor  id="descripcion" value="#{newsBean.actual.descripcion}" height="200" style="margin-bottom:10px" required="true" requiredMessage="#{msg['obligatoryField']}">
										        <f:facet name="toolbar">
										             <span class="ql-formats">
										                <button class="ql-bold"></button>
										                <button class="ql-italic"></button>
										                <button class="ql-underline"></button>
										                <button class="ql-strike"></button>
										            </span>
										            <span class="ql-formats">
										                <select class="ql-font"></select>
										                <select class="ql-size"></select>
										            </span>
										            <span class="ql-formats">
										            	<button class="ql-list" value="ordered"></button>
										                <button class="ql-list" value="bullet"></button>
										            </span>
										            <span class="ql-formats">
										            	<select class="ql-align"></select>
										            </span>
										            <span class="ql-formats">
										            	<button class="ql-link"></button>
										            </span>
										        </f:facet>
										    </p:textEditor> 
											<p:message for="descripcion" display="text"/>
										</div>
									</div>
									<div class="clearfix"></div>
								</div>
								<div class="box-footer">
									<div class="ln_solid"></div>
									<div class="form-group">
										<div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-4">
											<p:commandButton title="Guardar" process="@form" action="#{newsBean.saveNews()}" styleClass="btn-ic" icon="ic-btn ic-btn-save"
												update=":form1 :formRegisterNew" onstart="PF('statusDialog').show();" onsuccess="PF('statusDialog').hide();" />
											<p:commandButton rendered="#{newsBean.actual.id ne null}" title="Eliminar" process="@form" action="#{newsBean.deleteNews(newsBean.actual)}" styleClass="btn-ic" icon="ic-btn ic-btn-trash"
												update=":form1 :formRegisterNew" onstart="PF('statusDialog').show();" onsuccess="PF('statusDialog').hide();" >
												<p:confirm header="Eliminar" message="¿Está seguro que desea ELIMINAR la noticia?" />
											</p:commandButton>
											<p:commandButton title="#{msg['lbl.cancelar']}" process="@this" styleClass="btn-ic" icon="ic-btn ic-btn-cancel" action="#{newsBean.cancel()}" update=":form1 :formRegisterNew"/>												
										</div>
									</div>
								</div>
							</div>
						</div>
					</h:panelGroup>
				</h:form>
			</ui:define>
		</ui:composition>
	</h:body>
</f:view>
</html>