<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<h:head>
		<title>#{msg['msg.tituloPrincipal']}</title>
	</h:head>
	<h:body>
		<ui:composition template="/layouts/default.xhtml">
			<ui:define name="content">
				<p:outputPanel id="pnlGeneral">
					<div class="col-sm-12">
						<div class="box">
							<p:messages id="messages" showDetail="true" autoUpdate="false" closable="true" globalOnly="true" for="form1" />
							<div class="box-head">
								<label class="title-head">Servicios</label>
							</div>
							<div class="box-body">
								<p:outputPanel id="pnlServicesList" rendered="#{servicesBean.service eq null and servicesBean.showForm1 eq false}">
									<h:form prependId="false" id="form1">
										<div class="col-sm-12 x_title panel-heading">
											<label class="subtitle-head">Listado Servicios</label>
										</div>
										<div class="col-lg-12 col-sm-12 col-xs-12 text-center">
											<div class="row">
												<div class="col-sm-offset-9">
													<p:commandButton title="#{msg['lbl.nuevo']}" process="@this" action="#{servicesBean.nuevo()}"
														onstart="showSpinner();" onsuccess="hideSpinner();" update="pnlGeneral,pnlNewService"
														styleClass="btn-ic" icon="ic-btn ic-btn-new" />
												</div>
												<div class="col-md-6 col-md-push-3">
													<p:dataTable id="tblServices" widgetVar="table1" var="service" value="#{servicesBean.servicesFatherList}" rows="10" paginator="true" paginatorAlwaysVisible="false" paginatorPosition="bottom"
														paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" emptyMessage="No se encontraron registros" rowsPerPageTemplate="5,10,15">
														<p:column headerText="NOMBRE SERVICIO" priority="1">
															<h:outputText value="#{service.nameService}" /> 
														</p:column>
														<p:column headerText="CÓDIGO" priority="2">
															<h:outputText value="#{service.code}" />
														</p:column>
														<p:column width="100">
															<p:commandButton process="@this" action="#{servicesBean.loadInfoService(service)}" title="#{msg['lbl.editar']}" styleClass="btn-ic-little" icon="ic-btn-little ic-btn-edit btn-table" update="pnlGeneral,pnlNewService" />
															<p:commandButton process="@this" action="#{servicesBean.addServices(service)}" title="Subservicios" styleClass="btn-ic-little" icon="ic-btn-little ic-btn-view btn-table" update="pnlGeneral,pnlSubService" />
														</p:column> 
													</p:dataTable> 
												</div>
											</div>
										</div>
									</h:form>
								</p:outputPanel>
								
								<p:outputPanel id="pnlNewService" rendered="#{servicesBean.service ne null and servicesBean.showForm1 eq true}">
									<h:form id="formNewService" prependId="false">
										<div class="col-sm-12 x_title panel-heading">
											<label class="subtitle-head">#{servicesBean.service.id eq null ? 'Registrar' : 'Editar'} Servicio</label>
										</div>
										<div class="form-group col-md-12">
											<div class="form-group col-md-3">
												<label for="nombre_servicio" class="col-sm-12 control-label required">Nombre del servicio</label>
												<h:inputText type="text" class="form-control" id="nombre_servicio" placeholder="Nombre del servicio" autocomplete="off"
													value="#{servicesBean.service.nameService}" required="true" requiredMessage="#{msg['obligatoryField']}"/>
												<p:message for="nombre_servicio" />
											</div>
											<div class="form-group col-md-2">
												<label for="codigo" class="col-sm-12 control-label required">Código</label>
												<h:inputText type="text" class="form-control" id="codigo" placeholder="Código del servicio" autocomplete="off"
													value="#{servicesBean.service.code}" required="true" requiredMessage="#{msg['obligatoryField']}"/>
												<p:message for="codigo" />
											</div>
											<div class="form-group col-md-4">
												<div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-4">
													<p:commandButton process="@form"
														action="#{servicesBean.saveService()}" styleClass="btn-ic"
														icon="ic-btn ic-btn-save"
														update="pnlGeneral,pnlServicesList, pnlNewService"
														onstart="PF('statusDialog').show();"
														onsuccess="PF('statusDialog').hide();" />
													<p:commandButton process="@form"
														action="#{servicesBean.deleteService()}" styleClass="btn-ic"
														icon="ic-btn ic-btn-trash"
														update="pnlGeneral, pnlServicesList, pnlNewService"
														onstart="PF('statusDialog').show();"
														onsuccess="PF('statusDialog').hide();" />
													<p:commandButton title="#{msg['lbl.cancelar']}"
														process="@this" styleClass="btn-ic"
														icon="ic-btn ic-btn-cancel"
														action="#{servicesBean.cancel()}"
														update="pnlGeneral, pnlServicesList, pnlNewService" />
												</div>
											</div>
										</div>
									</h:form>
								</p:outputPanel>
								
								<p:outputPanel id="pnlSubService" rendered="#{servicesBean.subService eq null and servicesBean.showFormService2 eq true}">
									<h:form id="formSubService" prependId="false">	
										<div class="col-sm-12 x_title panel-heading">
											<label class="subtitle-head">Subservicios</label>
											<div class="col-sm-offset-9">
												<p:commandButton title="#{msg['lbl.nuevo']}" process="@this" action="#{servicesBean.nuevoSubService()}"
													onstart="showSpinner();" onsuccess="hideSpinner();" update="pnlGeneral,pnlNewSubService"
													styleClass="btn-ic" icon="ic-btn ic-btn-new" />
												<p:commandButton title="#{msg['lbl.cancelar']}" process="@this" action="#{servicesBean.back()}"
													onstart="showSpinner();" onsuccess="hideSpinner();" update="pnlGeneral, pnlServicesList, pnlSubService"
													styleClass="btn-ic" icon="ic-btn ic-btn-cancel" />
											</div>
										</div>
										<div class="form-group col-md-12">
											<div class="col-md-8 col-md-push-2">
												<p:dataTable id="tblSubServices" var="ss" value="#{servicesBean.servicesList}" rows="10" paginator="true" paginatorAlwaysVisible="false"
													paginatorPosition="bottom"
													paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
													emptyMessage="No se encontraron registros"
													rowsPerPageTemplate="5,10,15">
													<f:facet name="header">
												        	SUBSERVICIOS
												    </f:facet>
													<p:column headerText="NOMBRE SERVICIO" priority="1">
														<h:outputText value="#{ss.nameService}" />
													</p:column>
													<p:column headerText="CÓDIGO" priority="2">
														<h:outputText value="#{ss.code}" />
													</p:column>
													<p:column headerText="SERVICIO PRINCIPAL" priority="3">
														<h:outputText value="#{ss.serviceFather.nameService}" />
													</p:column>
													<p:column>
														<p:commandButton process="@this" action="#{servicesBean.loadInfoSubService(ss)}"
															title="#{msg['lbl.editar']}" styleClass="btn-ic-little"
															icon="ic-btn-little ic-btn-edit btn-table" update="pnlGeneral, pnlNewSubService" />
														<p:commandButton process="@this" action="#{servicesBean.deleteSubService(ss)}"
															title="#{msg['lbl.eliminar']}" styleClass="btn-ic-little" icon="ic-btn-little ic-btn-trash btn-table"
															update="pnlGeneral, pnlNewSubService, pnlSubService" />
													</p:column>
												</p:dataTable>
											</div>
										</div>
									</h:form>
								</p:outputPanel>
								
								<p:outputPanel id="pnlNewSubService" rendered="#{servicesBean.subService ne null and servicesBean.showFormService2 eq false}">
									<h:form id="formNewSubService" prependId="false">
										<div class="col-sm-12 x_title panel-heading">
											<label class="subtitle-head">#{servicesBean.subService.id eq null ? 'Registrar' : 'Editar'} SubServicio</label>
										</div>
										<div class="form-group col-md-12">
											<div class="form-group col-md-3">
												<label for="nombre_servicio1" class="col-sm-12 control-label required">Nombre del servicio</label>
												<h:inputText type="text" class="form-control" id="nombre_servicio1" placeholder="Nombre del servicio" autocomplete="off"
													value="#{servicesBean.subService.nameService}" required="true" requiredMessage="#{msg['obligatoryField']}"/>
												<p:message for="nombre_servicio1" />
											</div>
											<div class="form-group col-md-2">
												<label for="codigo1" class="col-sm-12 control-label required">Código</label>
												<h:inputText type="text" class="form-control" id="codigo1" placeholder="Código del servicio" autocomplete="off"
													value="#{servicesBean.subService.code}" required="true" requiredMessage="#{msg['obligatoryField']}"/>
												<p:message for="codigo1" />
											</div>
											<div class="form-group col-md-3">
												<label for="servicio_pr1" class="col-sm-12 control-label">Servicio Principal</label>
												<h:selectOneMenu required="true" styleClass="form-control" id="servicio_pr1" converter="hdsConvertEntity"
													value="#{servicesBean.serviceFather}" requiredMessage="#{msg['obligatoryFieldList']}">
													<f:converter converterId="hdsConvertEntity" />
													<f:selectItem itemLabel="Seleccione un servicio" />
													<f:selectItems value="#{servicesBean.servicesFatherList}" var="sf" itemLabel="#{sf.nameService}" itemValue="#{sf}" />
												</h:selectOneMenu>
											</div>
											<div class="form-group col-md-4">
												<div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-4">
													<p:commandButton process="@form"
														action="#{servicesBean.saveSubService()}" styleClass="btn-ic"
														icon="ic-btn ic-btn-save"
														update="pnlGeneral, pnlNewSubService, pnlSubService"
														onstart="PF('statusDialog').show();"
														onsuccess="PF('statusDialog').hide();" />
													<p:commandButton title="#{msg['lbl.cancelar']}"
														process="@this" styleClass="btn-ic"
														icon="ic-btn ic-btn-cancel"
														action="#{servicesBean.cancel2()}"
														update="pnlGeneral, pnlNewSubService, pnlSubService" />
												</div>
											</div>
										</div>
									</h:form>
								</p:outputPanel>
							</div>
						</div>
					</div>
				</p:outputPanel>
			</ui:define>
		</ui:composition>
	</h:body>
</f:view>
</html>