<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<h:head>
		<title>#{msg['msg.tituloPrincipal']}</title>
	</h:head>
	<h:body>
		<ui:composition template="/layouts/default.xhtml">
			<ui:define name="content">

				<h:form prependId="false" id="form1">
					<div class="col-sm-12">
						<div class="box">

							<p:messages id="messages" showDetail="true" autoUpdate="false"
								closable="true" globalOnly="true" for="form1" />

							<div class="box-head">
								<label class="title-head">Asignar módulos a usuarios</label>
							</div>

							<div class="box-body">

								<p:outputPanel id="pnlUsers">
									<div class="col-lg-4 col-md-4 col-sm-12">
										<p:dataTable id="tblPersons" widgetVar="table1" var="user"
											value="#{digiTurnoBean.users}" paginatorAlwaysVisible="false"
											paginatorPosition="bottom" rows="8" paginator="true"
											paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
											emptyMessage="#{msg['lbl.noRegistros']}"
											rowsPerPageTemplate="5,8,15">
											<f:facet name="header">
												<h:outputText value="Usuarios" />
											</f:facet>
											<p:column headerText="#{msg['lbl.usuarios']}"
												sortBy="#{user.username}" priority="2"
												filterBy="#{user.username} #{user.username}"
												filterMatchMode="contains">
												<h:outputText value="#{user.username}" />
											</p:column>

											<p:column width="15%">
												<p:commandButton process="@this"
													action="#{digiTurnoBean.loadModules(user)}" update="@form"
													title="#{msg['lbl.ver']}" styleClass="btn-ic-little"
													icon="ic-btn-little ic-btn-view btn-table"
													onstart="showSpinner();" onsuccess="hideSpinner();" />
											</p:column>

										</p:dataTable>
									</div>
								</p:outputPanel>
								<p:outputPanel id="pnlModulos" rendered="#{digiTurnoBean.showForm}">
									<div class="col-lg-4 col-md-4 col-sm-12">
										<div class="row">
											<div class="col-lg-10 col-md-10 col-sm-10">
												<p:outputPanel>
													<p:dataTable var="modules" value="#{digiTurnoBean.lista2}" widgetVar="table2"
														paginatorAlwaysVisible="false" paginatorPosition="bottom"
														rows="15" paginator="true"
														paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
														emptyMessage="#{msg['lbl.registrosVacios']}"
														rowsPerPageTemplate="5,5,15">
														<f:facet name="header">
															<h:outputText value="Módulos asignados" />
														</f:facet>
														<p:column headerText="Nombre">
															<h:outputText value="#{modules.nameModule}" />
														</p:column>
														<p:column headerText="Tipo">
															<h:outputText value="#{modules.typeModule}" />
														</p:column>
														<p:column width="15%">
															<p:commandButton process="@this"
																action="#{digiTurnoBean.deleteModuleUser(modules)}"
																update="@form" title="#{msg['lbl.ver']}"
																styleClass="btn-ic-little"
																icon="ic-btn-little ic-btn-trash btn-table"
																onstart="showSpinner();" onsuccess="hideSpinner();" />
														</p:column>

													</p:dataTable>

												</p:outputPanel>

											</div>

										</div>
									</div>

									<div class="col-lg-4 col-md-4 col-sm-12">
										<p:outputPanel id="pnlModuleAdd">
											<div class="col-lg-12 col-md-12 col-sm-12">
												<p:dataTable id="tblModuleAdd" widgetVar="table3"
													var="module" value="#{digiTurnoBean.lista}"
													paginatorAlwaysVisible="false" paginatorPosition="bottom"
													rows="8" paginator="true"
													paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
													emptyMessage="#{msg['lbl.registrosVacios']}"
													rowsPerPageTemplate="5,8,15">
													<f:facet name="header">
														<h:outputText value="Módulos sin asignar" />
													</f:facet>
													<p:column headerText="Nombre">
														<h:outputText value="#{module.nameModule}" />
													</p:column>
													<p:column headerText="Tipo">
														<h:outputText value="#{module.typeModule}" />
													</p:column>

													<p:column width="15%">
														<p:commandButton process="@this"
															action="#{digiTurnoBean.addModuleUser(module)}"
															update="@form" title="#{msg['lbl.ver']}"
															styleClass="btn-ic-little"
															icon="ic-btn-little ic-btn-new btn-table"
															onstart="showSpinner();" onsuccess="hideSpinner();" />
													</p:column>

												</p:dataTable>
											</div>
										</p:outputPanel>
									</div>

								</p:outputPanel>
							</div>
						</div>
					</div>
				</h:form>
			</ui:define>
		</ui:composition>
	</h:body>
</f:view>
</html>