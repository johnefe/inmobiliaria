<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui" >
<f:view >
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta
		content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
		name="viewport" />

			<link rel="stylesheet"
				href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/bootstrap.min.css" />
			<link rel="stylesheet"
				href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/proinsalud.css" />
			<link rel="stylesheet"
				href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/font-awesome.min.css" />
			<link rel="stylesheet"
				href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/ionicons.min.css" />

<!-- <link rel="stylesheet" -->
<!-- 		href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/bootstrapp.min.css" /> -->
<!-- 	<link rel="stylesheet" href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/proinsalud.css" /> -->
<!-- 	<link rel="stylesheet" -->
<!-- 		href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/font-awesome.min.css" /> -->
<!-- 	<link rel="stylesheet" -->
<!-- 		href="#{facesContext.externalContext.requestContextPath}/resources/assets/css/ionicons.min.css" /> -->

	<h:head>
		<title>#{msg['msg.tituloPrincipal']}</title>
	</h:head>
	<h:body style="background: #FAFAFA;">
		<p:outputPanel id="pnlGeneral">
			<h:form id="formSelectModule" prependId="false">
				<h:panelGroup id="pnlSelectModule">
					<p:outputPanel id="pnlModulo"
						rendered="#{digitalTurnAttentionBean.moduleUser eq null}">

						<section class="container py-5">
						<div class="col-lg-12 col-sm-12 col-xs-12 text-center py-5">
							<div class="row py-5">
								<div class="col-lg-8 offset-2 py-5">
									<table class="table table-bordered ">
										<thead>
											<tr class=""
												style="background: #7986CB; color: #fff; font-size: 20px;">
												<th class="text-center">SEDE</th>
												<th class="text-center">TIPO MODULO</th>
												<th class="text-center">NOMBRE MODULO</th>
												<th class="text-center">PUNTO</th>
												<th></th>
											</tr>
										</thead>
										<tbody>
											<ui:repeat var="moduloPunto"
												value="#{digitalTurnAttentionBean.moduleUserList}">
												<tr
													style="background: #9FA8DA; color: #fff; font-size: 20px;">
													<td>#{moduloPunto.module.point.sede.nameSede}</td>
													<td>#{moduloPunto.module.typeModule}</td>
													<td>#{moduloPunto.module.nameModule}</td>
													<td>#{moduloPunto.module.point.name}</td>
													<td><p:commandButton process="@this"
															action="#{digitalTurnAttentionBean.loadTempsByPoint(moduloPunto)}"
															title="#{msg['lbl.ver']}" styleClass="btn-ic-little"
															icon="ic-btn-little ic-btn-view btn-table"
															update="pnlGeneral,attention " /></td>
												</tr>
											</ui:repeat>
										</tbody>
									</table>
								</div>
							</div>
						</div>
						</section>

					</p:outputPanel>
				</h:panelGroup>
			</h:form>

			<h:panelGroup id="attention" rendered="#{digitalTurnAttentionBean.moduleUser ne null}">
				<div class="py-5">
					<h:form prependId="false" id="registerId">
					<p:poll interval="2" listener="#{digitalTurnAttentionBean.updateDate()}"></p:poll>
						<h:panelGroup >
							<div class="col-lg-12 col-sm-12 col-xs-12 text-center">
								<div class="row">
									<div class="col-lg-12">
										<h1>DIGITURNO PROINSALUD</h1>
									</div>
									<div class="clearfix"></div>
									<div class="col-lg-12 form-group py-5">
										<div class="row">
											<div class="col-lg-4 col-sm-offset-4">
												<div class="panel-group">
													<div class="panel panel-info">
														<div class="panel-heading">#{digitalTurnAttentionBean.moduleUser.module.nameModule}</div>
<!-- 														<div class="panel-body">#{digitalTurnAttentionBean.moduleUser.module.nameModule}</div> -->
													</div>
												</div>
											</div>
										</div>
										<div class="row">
											<div class="col-lg-5 col-sm-5">
												<div class="list-group">
													<div class="col-lg-12 col-sm-12 col-xs-12">
														<h:form id="formListTurn" prependId="false">
															<p:outputPanel id="pnlListTurn">
<!-- 																<div class="col-lg-12 form-group"> -->
<!-- 																	<h3>Lista de espera</h3> -->
<!-- 																</div> -->
																<h3>Lista de espera</h3>
																<p:scrollPanel style="width:auto;height:550px;" >
																	<table class="table table-responsive-sm table-bordered">
																		<thead>
																			<tr class="danger" style="text-align: center">
																				<th>Turno</th>
																				<th>Identificación</th>
																				<th>Servicio</th>
																				<th>Estado</th>
																				<th>Modulo</th>
																				<th></th>
																			</tr>
																		</thead>
																		<tbody>
																			<ui:repeat var="var"
																				value="#{digitalTurnAttentionBean.digitalTurnTempList}">
																				<tr class="#{var.color}">
																					<td>#{var.code}</td>
																					<td>#{var.identification}</td>
																					<td>#{var.service}</td>
																					<td>#{var.state}</td>
																					<td>#{var.digitalTurn.moduleUser.module.nameModule}</td>
																					<td>
																						<p:commandButton process="@form" action="#{digitalTurnAttentionBean.loadInfoTurn(var)}"
																							styleClass="btn-ic-little" icon="ic-btn-little ic-btn-view btn-table" update="formListTurn, formInfo" />
																					</td>
																				</tr>
																			</ui:repeat>
																		</tbody>
																	</table>
																</p:scrollPanel>
																<div class="clearfix"></div>
															</p:outputPanel>
														</h:form>
													</div>
												</div>
											</div>
											<div class="col-lg-6 col-sm-6" style="padding-top:55px;">
												<div class="list-group">
													<div class="col-lg-12 col-sm-12 col-xs-12">
														<h:form id="formInfo" prependId="false">
															<p:outputPanel id="pnlInfo" rendered="#{digitalTurnAttentionBean.digitalTurnTemp ne null}">
<!-- 																<div class="col-lg-12 form-group"> -->
<!-- 																	<h3>Información Turno</h3> -->
<!-- 																</div> -->
																<div class="panel-group">
																	<div class="panel panel-info">
																		<div class="panel-heading">Turno #{digitalTurnAttentionBean.digitalTurnTemp.code}</div>
																		<div class="panel-body">
																			<p:panelGrid columns="2" style="width:100%">
																				<h:outputText value="Número de identificación" style="max-width:300px"/>
																				<h:outputText value="#{digitalTurnAttentionBean.digitalTurnTemp.identification}" />

																				<h:outputText value="Nombre del usuario" style="max-width:300px"/>
																				<h:outputText value="#{digitalTurnAttentionBean.digitalTurnTemp.namePerson eq null ? 'No Registrado': digitalTurnAttentionBean.digitalTurnTemp.namePerson}" />

																				<h:outputText value="Servicio" style="max-width:300px"/>
																				<h:outputText value="#{digitalTurnAttentionBean.digitalTurnTemp.service}" />

																				<h:outputText value="Hora de llegada" style="max-width:300px"/>
																				<h:outputText value="#{digitalTurnAttentionBean.digitalTurnTemp.hourRegistered}">
																					<f:convertDateTime dateStyle="medium" type="date" pattern="dd-MM-yyyy hh:mm:ss" />
																				</h:outputText>
																				
																				<h:outputText value="Prioridad" style="max-width:300px"/>
																				<h:outputText value="#{digitalTurnAttentionBean.digitalTurnTemp.prefixOrder}" />
																			</p:panelGrid>
																			<div class="form-group">
																				<label for="comment">Observaciones</label>
																				<h:inputTextarea class="form-control" rows="6" value="#{digitalTurnAttentionBean.digitalTurnTemp.observation}" style="resize: none;" />
																			</div>
																			<div class="clearfix"></div>
																			<div class="btn-group">
																				<p:commandButton process="@this" action="#{digitalTurnAttentionBean.callingTurn()}" styleClass="btn btn-success" update="pnlListTurn,pnlInfo" value="Llamar"/>
																				<p:commandButton process="@this" action="#{digitalTurnAttentionBean.cancelTurn()}" styleClass="btn btn-danger" update="pnlGeneral,pnlInfo" value="Cancelar llamado"/>
																				<p:commandButton process="@this" action="#{digitalTurnAttentionBean.startAttentionTurn()}" styleClass="btn btn-warning" update="pnlGeneral,pnlInfo" value="En atención" disabled="#{digitalTurnAttentionBean.activate eq false}"/>
																				<p:commandButton process="@this" action="#{digitalTurnAttentionBean.finishAttentionTurn()}" styleClass="btn btn-danger" update="pnlGeneral,pnlInfo" value="Finalizar atención" disabled="#{digitalTurnAttentionBean.activate eq false}"/>
																			</div>
																		</div>
																	</div>
																</div>
															</p:outputPanel>
														</h:form>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</h:panelGroup>
					</h:form>
				</div>
			</h:panelGroup>
		</p:outputPanel>
<!-- 		<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/resources/assets/js/proinsalud.js"></script> -->
	</h:body>
</f:view>
</html>