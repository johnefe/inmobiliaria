<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core">
<f:view>
	<h:head>
		<title>#{proinsaludBean.optionSelectedApp != null ? proinsaludBean.optionSelectedApp.name: msg['msg.tituloPrincipal']}</title>
	</h:head>
	<h:body>
		<ui:composition template="/layouts/default.xhtml">
			<ui:define name="content">

				<h:form prependId="false" id="form1">
					<div class="col-sm-12">

						<div class="box">
							<p:messages id="messages" showDetail="true" autoUpdate="false" closable="true" globalOnly="true" for="form1" />

							<div class="box-head">
								<label class="title-head">#{msg['lbl.administrarItemsTrd']}</label>
							</div>

							<div class="box-body">

								<p:outputPanel id="pnlItems">
									<div class="col-sm-12">
										<p:outputPanel id="pnlListadoItems" rendered="#{!trdItemBean.showForm}">
											<div class="col-lg-8 col-lg-offset-2 col-md-12 col-sm-12">
												<label class="subtitle-head">#{msg['lbl.listadoItems']}</label>
												<div class="div-btn-header">
													<p:commandButton title="#{msg['lbl.nuevo']}" action="#{trdItemBean.loadForm}" process="@this" update="@([id$=pnlItems]),messages" onstart="showSpinner();" onsuccess="hideSpinner();" styleClass="btn-ic" icon="ic-btn ic-btn-new" />
												</div>
											</div>

											<div class="clearfix"></div>

											<div class="col-lg-8 col-lg-offset-2 col-md-12 col-sm-12">

												<p:dataTable id="tblItemsTrd" var="item" value="#{trdItemBean.trdItems}" paginatorAlwaysVisible="false" paginatorPosition="bottom" rows="5" paginator="true"
													paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" emptyMessage="#{msg['lbl.noRegistros']}" rowsPerPageTemplate="5,10,15">

													<p:column headerText="Código" sortBy="#{item.code}" priority="2" filterBy="#{item.code}" filterMatchMode="contains">
														<h:outputText value="#{item.code}" />
													</p:column>
													<p:column headerText="Nombre" priority="3">
														<h:outputText value="#{item.name}" />
													</p:column>
													<p:column headerText="Nivel" priority="2">
														<h:outputText value="#{item.level.nameLevel}" />
													</p:column>

													<p:column width="60">
														<p:commandButton process="@this" action="#{trdItemBean.loadTrdItemById(item.id)}" update="@form" title="#{msg['lbl.ver']}" styleClass="btn-ic-little" icon="ic-btn-little ic-btn-edit btn-table" onstart="showSpinner();" onsuccess="hideSpinner();" />
													</p:column>

												</p:dataTable>
											</div>


										</p:outputPanel>

										<p:outputPanel id="pnlFormItem" rendered="#{trdItemBean.showForm}">
											<div class="col-sm-12">
												<label class="subtitle-head">#{msg['lbl.registrarItem']}</label>
											</div>

											<div class="clearfix"></div>
											<div class="col-sm-12">

												<div class="col-md-4 col-xs-12 form-group">
													<label for="codigo" class="col-sm-12 control-label required">Codigo</label>
													<div class="col-sm-12">
														<h:inputText type="text" required="true" class="form-control" id="codigo" value="#{trdItemBean.trdItem.code}" requiredMessage="#{msg['obligatoryField']}" />
														<p:watermark value="Digite el código" for="codigo"></p:watermark>
														<p:message for="codigo" />
													</div>
												</div>


												<div class="col-md-4 col-xs-12 form-group">
													<label for="nombre" class="col-sm-12 control-label required">Nombre</label>
													<div class="col-sm-12">
														<h:inputText type="text" required="true" class="form-control" id="nombre" placeholder="Nombre" value="#{trdItemBean.trdItem.name}" requiredMessage="#{msg['obligatoryField']}" />
														<p:watermark value="Digite el código" for="nombre"></p:watermark>
														<p:message for="nombre" />
													</div>
												</div>

												<div class="col-md-4 col-xs-12 form-group">
													<label for="levelI" class="col-sm-12 control-label required">Nivel</label>
													<h:selectOneMenu required="true" styleClass="form-control" id="levelI" value="#{trdItemBean.trdItem.level}" converter="hdsConvertEntity" requiredMessage="#{msg['obligatoryFieldList']}">
														<f:converter converterId="hdsConvertEntity" />
														<f:selectItem itemLabel="Seleccione un nivel" />
														<f:selectItems required="true" value="#{trdItemBean.levelTrds}" var="level" itemLabel="#{level.nameLevel}" itemValue="#{level}" />
														<p:ajax event="change" update="msg_levelI"></p:ajax>
													</h:selectOneMenu>
													<p:message for="levelI" id="msg_levelI" />
												</div>


											</div>

											<div class="clearfix"></div>

											<div class="col-sm-12">
												<div class="div-btn">
													<p:commandButton title="#{msg['lbl.guardar']}" process="@form" action="#{trdItemBean.saveTrdItem}" update="@form" onstart="showSpinner();" onsuccess="hideSpinner();" styleClass="btn-ic" icon="ic-btn ic-btn-save" />
													<p:commandButton title="#{msg['lbl.cancelar']}" process="@this" action="#{trdItemBean.cancel()}" update="@form" styleClass="btn-ic" icon="ic-btn ic-btn-cancel">
														<p:resetInput target="pnlFormItem" />
													</p:commandButton>
												</div>
											</div>
										</p:outputPanel>


									</div>
								</p:outputPanel>
							</div>

						</div>
					</div>

				</h:form>
			</ui:define>
		</ui:composition>
	</h:body>
</f:view>
</html>